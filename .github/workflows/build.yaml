name: Build with Maven
on:
  workflow_dispatch:
  push:
    branches: [ main ] 
  # pull_request:  # Optional: Trigger on pull requests

env:
  QA: QA
jobs:
  workflowlevel:
    name: print env variable 
    runs-on: linux-github-runner 
    steps:
    - name: Print variable here
      run: |
        echo printing QA environment variable is define here ${{ env.QA }}

  job1:
    name: testing tasks 1 2 3
    runs-on: linux-github-runner
      #ec2-instance-linux  # ec2 instance connect label
    steps:
    - uses: actions/checkout@v4
    - name: Set up JDK 11 for x64
      uses: actions/setup-java@v4
      with:
        java-version: '8'
        distribution: 'temurin'
        architecture: x64

    - name: Set up Maven
      uses: stCarolas/setup-maven@v5
      with:
        maven-version: 3.8.2
    - name: Checkout repository
      uses: actions/checkout@v2

      #This can be replaced with actual FT tasks
    - name: Run Task1                          
      run: |
        cd TEST1
        mvn com.smartbear.soapui:soapui-maven-plugin:5.5.0:test
        cd ..

    - name: Run Task2
      run: |
        cd TEST2
        mvn com.smartbear.soapui:soapui-maven-plugin:5.5.0:test
        cd ..

    - name: Run Task3
      run: |
        cd TEST3
        mvn com.smartbear.soapui:soapui-maven-plugin:5.5.0:test
        cd ..

    - name: Run shell script
      run: |
        chmod 777 test.sh .
        ./test.sh


  job2:
    name: testing tasks 4 5 6
   
    runs-on: linux-github-runner
      #ec2-instance-linux  # ec2 instance connect label

    steps:
    - uses: actions/checkout@v4
    - name: Set up JDK 11 for x64
      uses: actions/setup-java@v4
      with:
        java-version: '8'
        distribution: 'temurin'
        architecture: x64

    - name: Set up Maven
      uses: stCarolas/setup-maven@v5
      with:
        maven-version: 3.8.2

    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Run Task4
      run: |
        cd TEST4
        mvn com.smartbear.soapui:soapui-maven-plugin:5.5.0:test
        cd ..
    - name: Run Task5
      run: |
        cd TEST5
        mvn com.smartbear.soapui:soapui-maven-plugin:5.5.0:test
        cd ..

    - name: Run Task6
      run: |
        cd TEST6
        mvn com.smartbear.soapui:soapui-maven-plugin:5.5.0:test
        cd ..

    - name: Run shell script
      run: |
        echo "test started"
        ls -a
        pwd
        echo "testing is completed"

  # job3:
  #   name: Actual workflow
  #   runs-on: linux-github-runner
      
  #   steps:
  #   - name: Check out
  #     uses: actions/checkout@v3
 
  #   - name: Setup Java
  #     uses: actions/setup-java@v3
  #     with:
  #       java-version: '8'
  #       distribution: 'corretto'
  #       cache: 'maven'
  #     id: test
  #   - name: Rest_Add_Edit_Admin_Options
  #     run: | 
  #       cd Rest_Add_Edit_Admin_Options
  #       python3 runWithMaven.py -hostport $hostport -userName $userName -password $password -environment $environment -secureProtocol YES -endPoint $endpoint -apiKey $apiKey -project $project 
  #       cd ..
  #     if: always()